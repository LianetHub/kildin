(()=>{"use strict";function e(e,t,n,o){void 0===t&&(t=400),void 0===o&&(o=!1),e.style.overflow="hidden",o&&(e.style.display="block");var l,i=window.getComputedStyle(e),a=parseFloat(i.getPropertyValue("height")),s=parseFloat(i.getPropertyValue("padding-top")),r=parseFloat(i.getPropertyValue("padding-bottom")),c=parseFloat(i.getPropertyValue("margin-top")),d=parseFloat(i.getPropertyValue("margin-bottom")),p=a/t,u=s/t,m=r/t,g=c/t,y=d/t;window.requestAnimationFrame((function i(v){void 0===l&&(l=v);var h=v-l;o?(e.style.height=p*h+"px",e.style.paddingTop=u*h+"px",e.style.paddingBottom=m*h+"px",e.style.marginTop=g*h+"px",e.style.marginBottom=y*h+"px"):(e.style.height=a-p*h+"px",e.style.paddingTop=s-u*h+"px",e.style.paddingBottom=r-m*h+"px",e.style.marginTop=c-g*h+"px",e.style.marginBottom=d-y*h+"px"),h>=t?(e.style.height="",e.style.paddingTop="",e.style.paddingBottom="",e.style.marginTop="",e.style.marginBottom="",e.style.overflow="",o||(e.style.display="none"),"function"==typeof n&&n()):window.requestAnimationFrame(i)}))}document.addEventListener("DOMContentLoaded",(()=>{function e(){const e=document.querySelectorAll(".navigation__item"),t=document.querySelector(".navigation__item:not(.active):not(:first-child)").getBoundingClientRect().width;let n=e.length*t,o=0;e.forEach(((l,i)=>{let a=i+1;l.classList.contains("active")&&(n=(e.length-a)*t,o=a*t)})),document.body.style.setProperty("--padding-wrapper-right",`${n}px`),document.body.style.setProperty("--padding-wrapper-left",`${o}px`)}function t(){o(),function(){const e=document.querySelectorAll("[data-spollers]");if(e.length>0){const t=Array.from(e).filter((function(e,t,n){return!e.dataset.spollers.split(",")[0]}));t.length>0&&o(t);const n=Array.from(e).filter((function(e,t,n){return e.dataset.spollers.split(",")[0]}));if(n.length>0){const e=[];n.forEach((t=>{const n={},o=t.dataset.spollers.split(",");n.value=o[0],n.type=o[1]?o[1].trim():"max",n.item=t,e.push(n)}));let t=e.map((function(e){return"("+e.type+"-width: "+e.value+"px),"+e.value+","+e.type}));t=t.filter((function(e,t,n){return n.indexOf(e)===t})),t.forEach((t=>{const n=t.split(","),l=n[1],i=n[2],a=window.matchMedia(n[0]),s=e.filter((function(e){if(e.value===l&&e.type===i)return!0}));a.addListener((function(){o(s,a)})),o(s,a)}))}function o(e,t=!1){e.forEach((e=>{e=t?e.item:e,t.matches||!t?(e.classList.add("_init"),l(e),e.addEventListener("click",i)):(e.classList.remove("_init"),l(e,!1),e.removeEventListener("click",i))}))}function l(e,t=!0){const n=e.querySelectorAll("[data-spoller]");n.length>0&&n.forEach((e=>{t?(e.removeAttribute("tabindex"),e.classList.contains("_active")||(e.nextElementSibling.hidden=!0)):(e.setAttribute("tabindex","-1"),e.nextElementSibling.hidden=!1)}))}function i(e){const t=e.target;if(t.hasAttribute("data-spoller")||t.closest("[data-spoller]")){const n=t.hasAttribute("data-spoller")?t:t.closest("[data-spoller]"),o=n.closest("[data-spollers]"),l=!!o.hasAttribute("data-one-spoller");o.querySelectorAll("._slide").length||(l&&!n.classList.contains("_active")&&a(o),n.classList.toggle("_active"),n.nextElementSibling.slideToggle(300)),e.preventDefault()}}function a(e){const t=e.querySelector("[data-spoller]._active");t&&(t.classList.remove("_active"),t.nextElementSibling.slideUp(300))}}}(),document.querySelectorAll("select[multiple]").forEach((e=>{var t=e.querySelectorAll("option"),n=document.createElement("div");n.classList.add("selectMultiple");var o=document.createElement("div");o.classList.add("active");var l=document.createElement("ul"),i=e.dataset.placeholder,a=document.createElement("span");a.innerText=i,o.appendChild(a),t.forEach((e=>{let t=e.innerText;if(e.selected){let n=document.createElement("a");n.dataset.value=e.value,n.innerHTML="<em>"+t+"</em><i></i>",o.appendChild(n),a.classList.add("hide")}else{let n=document.createElement("li");n.dataset.value=e.value,n.innerHTML=t,l.appendChild(n)}}));var s=document.createElement("div");s.classList.add("arrow"),o.appendChild(s),n.appendChild(o),n.appendChild(l),e.parentElement.append(n),a.appendChild(e)})),document.querySelectorAll(".selectMultiple ul").forEach((e=>{e.addEventListener("click",(e=>{let t=e.target.closest("li");if(!t)return;let n=t.closest(".selectMultiple");if(!n.classList.contains("clicked")){n.classList.add("clicked"),t.previousElementSibling&&t.previousElementSibling.classList.add("beforeRemove"),t.nextElementSibling&&t.nextElementSibling.classList.add("afterRemove"),t.classList.add("remove");let e=document.createElement("a");e.dataset.value=t.dataset.value,e.innerHTML="<em>"+t.innerText+"</em><i></i>",e.classList.add("notShown"),n.querySelector("div").appendChild(e),n.querySelector("select").querySelector('option[value="'+t.dataset.value+'"]').setAttribute("selected","selected"),setTimeout((()=>{e.classList.add("shown"),n.querySelector("span").classList.add("hide")}),300),setTimeout((()=>{let e=window.getComputedStyle(t),o=e.height,l=e.padding;t.animate([{height:o,padding:l},{height:"0px",padding:"0px"}],{duration:300,easing:"ease-in-out"}).onfinish=()=>{t.previousElementSibling&&t.previousElementSibling.classList.remove("beforeRemove"),t.nextElementSibling&&t.nextElementSibling.classList.remove("afterRemove"),t.remove(),n.classList.remove("clicked")}}),300)}}))})),document.querySelectorAll(".selectMultiple > div").forEach((e=>{e.addEventListener("click",(e=>{let t=e.target.closest("a"),n=e.target.closest(".selectMultiple");if(!t)return;t.className="",t.classList.add("remove"),console.log("work 2"),n.classList.add("open");let o=n.querySelector("select");o.querySelector('option[value="'+t.dataset.value+'"]').removeAttribute("selected"),t.classList.add("disappear"),setTimeout((()=>{let e=window.getComputedStyle(t),l=e.padding,i=e.width,a=e.height,s=t.animate([{width:i,height:a,padding:l},{width:"0px",height:"0px",padding:"0px"}],{duration:0,easing:"ease-in-out"}),r=document.createElement("li");r.dataset.value=t.dataset.value,r.innerText=t.querySelector("em").innerText,r.classList.add("show"),n.querySelector("ul").appendChild(r),setTimeout((()=>{o.selectedOptions.length||n.querySelector("span").classList.remove("hide"),r.className=""}),350),s.onfinish=()=>{t.remove()}}),300)}))})),document.querySelectorAll(".selectMultiple > div .arrow, .selectMultiple > div span").forEach((e=>{e.addEventListener("click",(t=>{document.querySelectorAll(".selectMultiple.open").forEach((e=>{e!==t.target.closest(".selectMultiple")&&e.classList.remove("open")})),e.closest(".selectMultiple").classList.toggle("open")}))})),document.querySelectorAll(".popup__slider")&&document.querySelectorAll(".popup__slider").forEach((e=>{let t=e.querySelector(".popup__next"),n=e.querySelector(".popup__prev");new Swiper(e,{speed:800,slidesPerView:1,navigation:{nextEl:t,prevEl:n}})})),document.querySelectorAll(".article__slider")&&document.querySelectorAll(".article__slider").forEach((e=>{let t=e.querySelector(".article__slider-prev"),n=e.querySelector(".article__slider-next");new Swiper(e,{slidesPerView:1,navigation:{nextEl:n,prevEl:t}})})),"undefined"!=typeof Fancybox&&null!==Fancybox&&(Fancybox.bind("[data-fancybox]"),Fancybox.defaults.closeButton=!1,Fancybox.defaults.dragToClose=!1)}function n(){if(document.querySelector("#map")){document.querySelector("#map").innerHTML="";var e=new ymaps.Map("map",{center:[69.34898894941716,34.18545550000002],zoom:12,controls:[]});document.querySelectorAll(".maps__placemark")&&(document.querySelectorAll(".maps__placemark").forEach((t=>{let n=t.dataset.coords.split(","),o=t.dataset.modal;var l=new ymaps.Placemark(n,{},{iconLayout:"default#image",iconImageHref:"/img/icons/location.svg",modalId:o});e.geoObjects.add(l)})),e.geoObjects.events.add("click",(function(e){var t=e.get("target").options._options.modalId;Fancybox.show([{src:t}])})))}}async function o(){if(!document.querySelector(".maps__filters"))return void ymaps.ready(n);let e=new FormData(document.querySelector(".maps__filters")),t={};e.forEach((function(e,n){t.hasOwnProperty(n)?t[n].push(e):(t[n]=e,"object"!==n&&(t[n]=Array.from(t[n])))}));let o=JSON.stringify(t);console.log(o);try{let e=await fetch("https://monitoring.dev.ecofactor.pro/api/v1/requests/filter/",{method:"POST",body:o});e.ok&&(!function(e){let t=document.querySelector(".maps__placemarks"),n=document.querySelector(".maps__modals");t.innerHTML="",n.innerHTML="";let{requests:o}=e;o.forEach((e=>{let{id:o,coordinates:l,req_popup:i}=e;n.innerHTML+=i;let a=document.createElement("div");a.classList.add("maps__placemark"),a.setAttribute("data-coords",l),a.setAttribute("data-modal",`#modal-${o}`),t.appendChild(a)}))}(await e.json()),ymaps.ready(n))}catch(e){console.log(e)}}barba.init({preventRunning:!0,prefetchIgnore:!0,transitions:[{name:"base",async leave(t){window.innerWidth<767&&barba.go(t.trigger.href),await function(t){let n=t.trigger.closest(".navigation__item");return n||(n=document.querySelector(".navigation__item")),document.querySelector(".navigation").classList.add("pending"),gsap.to(n,{width:"100%",duration:.5,ease:"power2.in"}).then((()=>{!function(t){document.querySelectorAll(".navigation__item").forEach((e=>{e.classList.remove("active")})),t&&t.classList.add("active"),e()}(t.trigger.closest(".navigation__item"))}))}(t),t.current.container.remove()},async enter(e){await function(){let e=document.querySelector(".navigation__item.active");return e||(e=document.querySelector(".navigation__item")),gsap.to(e,{width:"auto",duration:.5,ease:"power2.out"}).then((()=>{document.querySelector(".navigation").classList.remove("pending")}))}(e.next.container)},async afterEnter(){document.querySelectorAll("video").forEach((e=>{var t=e.play();void 0!==t&&t.then((e=>{})).catch((e=>{}))})),t()}}]}),e(),t(),window.addEventListener("resize",(()=>{e()})),document.addEventListener("click",(e=>{const t=e.target;t.closest(".icon-menu")&&(document.querySelector(".navigation").classList.toggle("open"),function(e){const t=document.body;let n,o="lock";t.classList.contains(o)?(n=parseInt(document.body.dataset.position,10),t.dataset.position=n,t.style.top=-n+"px"):(n=window.scrollY,t.style.top="auto",window.scroll({top:n,left:0}),document.body.removeAttribute("data-position"));let l=t.classList.contains(o)?"0px":window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";t.style.paddingRight=l,t.classList.toggle(o)}(),document.querySelector(".icon-menu").classList.toggle("active")),t.classList.contains("maps__btn")&&(e.preventDefault(),o())}))})),HTMLElement.prototype.slideToggle=function(t,n){0===this.clientHeight?e(this,t,n,!0):e(this,t,n)},HTMLElement.prototype.slideUp=function(t,n){e(this,t,n)},HTMLElement.prototype.slideDown=function(t,n){e(this,t,n,!0)}})();